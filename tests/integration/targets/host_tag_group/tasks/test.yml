---
- name: "{{ outer_item.version }} - Create host_tag_group."
  tribe29.checkmk.host_tag_group:
    server_url: "{{ server_url }}"
    site: "{{ outer_item.site }}"
    automation_user: "{{ automation_user }}"
    automation_secret: "{{ automation_secret }}"
    host_tag_group: "{{ host_tag_group }}"
    state: "present"
  delegate_to: localhost

- name: "{{ outer_item.version }} - Update host_tag_group."
  tribe29.checkmk.host_tag_group:
    server_url: "{{ server_url }}"
    site: "{{ outer_item.site }}"
    automation_user: "{{ automation_user }}"
    automation_secret: "{{ automation_secret }}"
    host_tag_group: "{{ updated_host_tag_group }}"
    state: "present"
  delegate_to: localhost

- name: "{{ outer_item.version }} - Delete host_tag_group."
  tribe29.checkmk.host_tag_group:
    server_url: "{{ server_url }}"
    site: "{{ outer_item.site }}"
    automation_user: "{{ automation_user }}"
    automation_secret: "{{ automation_secret }}"
    host_tag_group: "{{ host_tag_group }}"
    state: "absent"
  delegate_to: localhost
